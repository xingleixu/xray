# Xray 脚本语言

一门轻量化、高性能、兼容性好的脚本语言，使用 ANSI C 开发。

## 项目简介

Xray 是一门参考 Lua、Wren、QuickJS 设计的脚本语言，语法类似 TypeScript。项目目标：

- **代码规模**：< 10,000 行
- **性能目标**：介于 Wren 和 Lua 之间
- **可维护性**：优先于极致性能
- **易学习**：代码清晰，注释丰富

## 当前状态

**版本**：v0.1.0  
**开发阶段**：第一阶段完成（词法分析器）

### 已完成功能
- ✅ 完整的词法分析器
- ✅ 支持所有基本 Token 类型
- ✅ 注释处理（单行和多行）
- ✅ 数字识别（整数、浮点数、科学计数法）
- ✅ 字符串识别
- ✅ 关键字和标识符识别
- ✅ 命令行接口和 REPL

### 测试状态
- **C 语言测试**：53/53 通过 ✅
- **编译状态**：无警告、无错误 ✅

## 快速开始

### 编译

```bash
cd xray
make
```

### 运行

```bash
# 显示版本
./xray -v

# 显示帮助
./xray -h

# 运行 REPL（交互式环境）
./xray

# 执行脚本文件
./xray script.xr

# 执行代码字符串
./xray -e "let x = 10;"
```

### 运行测试

```bash
make test
```

### 清理

```bash
make clean
```

## 语法示例

### 变量定义
```javascript
let x = 10        // 变量声明
const PI = 3.14   // 常量声明
```

**注意**：Xray 不使用分号作为语句结束符，语句通过换行自动结束。分号仅用作特定语法的分隔符（如 for 循环）。

### 条件判断
```javascript
if (x > 5) {
    // 代码块
} else if (x == 5) {
    // 代码块
} else {
    // 代码块
}
```

### 循环
```javascript
// while 循环
while (condition) {
    // 循环体
}

// for 循环（注意：分号用作分隔符）
for (let i = 0; i < 10; i = i + 1) {
//              ^分隔  ^分隔
    // 循环体
}
```

### 数据类型
- `null` - 空值
- `int` - 整数
- `float` - 浮点数
- `string` - 字符串
- `array` - 数组（计划中）
- `set` - 集合（计划中）
- `map` - 映射（计划中）
- `class` - 类（计划中）

## 项目结构

```
xray/
├── xray.h           # 主头文件
├── xvalue.h/c       # 值类型系统
├── xstate.h/c       # 状态管理
├── xlex.h/c         # 词法分析器
├── main.c           # 主程序
├── Makefile         # 构建文件
├── example/         # 示例程序
│   ├── 01_hello.xr
│   ├── 02_variables.xr
│   └── 03_control_flow.xr
└── test/            # 测试程序
    └── test_lexer.c
```

## 开发路线图

- [x] **阶段一**：词法分析器 ✅
- [ ] **阶段二**：语法分析器（进行中）
- [ ] **阶段三**：虚拟机和字节码
- [ ] **阶段四**：运行时系统
- [ ] **阶段五**：标准库
- [ ] **阶段六**：优化和性能测试


## 参考资料

本项目在开发过程中参考了：
- **Lua** - 轻量高效的设计理念
- **Wren** - 优雅的语法和实现
- **QuickJS** - 完整的 JavaScript 实现

## 贡献指南

1. 代码必须清晰易懂，面向初学者
2. 所有注释使用中文
3. 每次提交前运行测试确保通过
4. 遵循项目的代码规范

## 许可证

待定

## 作者

Xray 开发团队

---

**最后更新**：2025-10-12

