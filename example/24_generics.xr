/*
** 24_generics.xr
** æ³›å‹ç¤ºä¾‹
** æ¼”ç¤ºXrayçš„æ³›å‹åŠŸèƒ½ï¼ˆåŸºç¡€ç‰ˆï¼‰
**
** æ³¨æ„ï¼šå®Œæ•´çš„æ³›å‹è¯­æ³•è§£æå°†åœ¨åç»­ç‰ˆæœ¬å®ç°
** æœ¬ç¤ºä¾‹å±•ç¤ºæ³›å‹çš„æ¦‚å¿µå’Œè®¾è®¡
*/

print("========== æ³›å‹ç¤ºä¾‹ ==========")
print("")

// ===== 1. æ³›å‹å‡½æ•°æ¦‚å¿µ =====
print("--- 1. æ³›å‹å‡½æ•°æ¦‚å¿µ ---")

// æ³›å‹identityå‡½æ•°ï¼ˆæ¦‚å¿µæ¼”ç¤ºï¼‰
// function identity<T>(x: T): T {
//     return x
// }

// ä½¿ç”¨ç¤ºä¾‹ï¼š
// let num = identity<int>(42)       // T = int
// let str = identity<string>("hello") // T = string

print("æ³›å‹å‡½æ•°ï¼šfunction identity<T>(x: T): T")
print("  - Tæ˜¯ç±»å‹å‚æ•°ï¼Œå¯ä»¥æ˜¯ä»»æ„ç±»å‹")
print("  - å‚æ•°xçš„ç±»å‹æ˜¯T")
print("  - è¿”å›ç±»å‹ä¹Ÿæ˜¯T")
print("")

print("è°ƒç”¨ç¤ºä¾‹ï¼š")
print("  identity<int>(42) â†’ 42 (ç±»å‹ï¼šint)")
print("  identity<string>(\"hello\") â†’ \"hello\" (ç±»å‹ï¼šstring)")
print("")

// ===== 2. å•ç±»å‹å‚æ•°æ³›å‹ =====
print("--- 2. å•ç±»å‹å‚æ•°æ³›å‹ ---")

// function first<T>(arr: T[]): T {
//     return arr[0]
// }

// let numbers = [1, 2, 3]
// let names = ["Alice", "Bob"]

// let firstNum = first<int>(numbers)     // T = int
// let firstName = first<string>(names)   // T = string

print("æ³›å‹æ•°ç»„å‡½æ•°ï¼šfirst<T>(arr: T[]): T")
print("  - å‚æ•°æ˜¯Tç±»å‹çš„æ•°ç»„")
print("  - è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆç±»å‹Tï¼‰")
print("")

print("å®ä¾‹åŒ–ç¤ºä¾‹ï¼š")
print("  first<int>([1,2,3]) â†’ 1 (ç±»å‹ï¼šint)")
print("  first<string>([\"A\",\"B\"]) â†’ \"A\" (ç±»å‹ï¼šstring)")
print("")

// ===== 3. å¤šç±»å‹å‚æ•°æ³›å‹ =====
print("--- 3. å¤šç±»å‹å‚æ•°æ³›å‹ ---")

// function pair<T, U>(first: T, second: U) {
//     return { first: first, second: second }
// }

// let p1 = pair<int, string>(1, "one")
// let p2 = pair<string, bool>("active", true)

print("å¤šæ³›å‹å‚æ•°ï¼špair<T, U>(first: T, second: U)")
print("  - Tå’ŒUæ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„ç±»å‹å‚æ•°")
print("  - å¯ä»¥æ˜¯ç›¸åŒæˆ–ä¸åŒç±»å‹")
print("")

print("å®ä¾‹åŒ–ç¤ºä¾‹ï¼š")
print("  pair<int, string>(1, \"one\") â†’ {1, \"one\"}")
print("  pair<string, bool>(\"active\", true) â†’ {\"active\", true}")
print("")

// ===== 4. æ³›å‹ç±»å‹çº¦æŸï¼ˆé¢„è§ˆï¼‰ =====
print("--- 4. æ³›å‹ç±»å‹çº¦æŸï¼ˆæœªæ¥åŠŸèƒ½ï¼‰ ---")

// å¸¦çº¦æŸçš„æ³›å‹ï¼ˆç¬¬12é˜¶æ®µå®ç°ï¼‰
// function printable<T extends Printable>(x: T) {
//     x.print()
// }

print("æ³›å‹çº¦æŸï¼ˆv0.12.0ï¼‰ï¼š")
print("  function printable<T extends Printable>(x: T)")
print("  - Tå¿…é¡»å®ç°Printableæ¥å£")
print("  - ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥")
print("")

// ===== 5. æ³›å‹å®ä¾‹åŒ–è¿‡ç¨‹ =====
print("--- 5. æ³›å‹å®ä¾‹åŒ–è¿‡ç¨‹ ---")

print("æ³›å‹å®ä¾‹åŒ–æ­¥éª¤ï¼š")
print("1. è§£ææ³›å‹å£°æ˜ï¼ˆfunction identity<T>ï¼‰")
print("2. è§£æç±»å‹å‚æ•°ï¼ˆTï¼‰")
print("3. æ³›å‹è°ƒç”¨æ—¶æŒ‡å®šç±»å‹ï¼ˆidentity<int>ï¼‰")
print("4. åˆ›å»ºç±»å‹å‚æ•°æ˜ å°„ï¼ˆT â†’ intï¼‰")
print("5. ç±»å‹æ›¿æ¢ï¼ˆTæ›¿æ¢ä¸ºintï¼‰")
print("6. æ‰§è¡Œå®ä¾‹åŒ–åçš„å‡½æ•°")
print("")

// ===== 6. æ³›å‹çš„ä¼˜åŠ¿ =====
print("--- 6. æ³›å‹çš„ä¼˜åŠ¿ ---")

print("âœ… ä»£ç å¤ç”¨ï¼š")
print("  - ä¸€ä¸ªæ³›å‹å‡½æ•°é€‚ç”¨å¤šç§ç±»å‹")
print("  - é¿å…ä¸ºæ¯ç§ç±»å‹å†™é‡å¤ä»£ç ")
print("")

print("âœ… ç±»å‹å®‰å…¨ï¼š")
print("  - ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥")
print("  - é¿å…ç±»å‹è½¬æ¢é”™è¯¯")
print("")

print("âœ… æ€§èƒ½ä¼˜åŒ–ï¼š")
print("  - LLVMåç«¯å¯ä»¥ç‰¹åŒ–ä¼˜åŒ–")
print("  - é¿å…è¿è¡Œæ—¶ç±»å‹æ£€æŸ¥å¼€é”€")
print("")

print("========== æ³›å‹ç¤ºä¾‹ç»“æŸ ==========")

/*
** æ³›å‹å®ç°çŠ¶æ€ï¼ˆv0.7.0ï¼‰ï¼š
** 
** âœ… å·²å®ç°ï¼š
** - ç±»å‹å‚æ•°ï¼ˆTYPE_PARAMï¼‰
** - ç±»å‹å‚æ•°æ˜ å°„ï¼ˆTypeParamMapï¼‰
** - ç±»å‹æ›¿æ¢ï¼ˆxr_type_substituteï¼‰
** 
** â³ å¾…å®ç°ï¼ˆåç»­ç‰ˆæœ¬ï¼‰ï¼š
** - æ³›å‹è¯­æ³•è§£æï¼ˆ<T>ï¼‰
** - æ³›å‹å‡½æ•°è°ƒç”¨
** - ç±»å‹å‚æ•°æ¨å¯¼ï¼ˆè‡ªåŠ¨æ¨æ–­Tçš„ç±»å‹ï¼‰
** - æ³›å‹çº¦æŸï¼ˆextendsï¼‰
** - æ³›å‹ç±»ï¼ˆç¬¬12é˜¶æ®µï¼‰
** 
** ğŸ“Š å½“å‰çŠ¶æ€ï¼š
** - æ ¸å¿ƒæ³›å‹åŸºç¡€è®¾æ–½å·²å®Œæˆ
** - å¯ä»¥æ‰‹åŠ¨åˆ›å»ºå’Œå®ä¾‹åŒ–æ³›å‹ç±»å‹
** - ä¸ºåç»­è¯­æ³•è§£æåšå¥½å‡†å¤‡
*/

